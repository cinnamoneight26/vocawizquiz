import{u as r,w as m,V as w,a as p,b as f,c as v}from"./VPagination-da5ea9c3.js";import{C as u,D as t,B as g,n as o,E as h,H as P,w as d,X as i,Y as L}from"./index-d27f97ba.js";import{_ as T,S as V,T as y,U as _,E as C,X as k,W as S,Y as D}from"./VSheet-1d80e05f.js";const x={name:"WordList",watch:{selectedLevel:function(){this.loadJsonAndGenerateQuiz()}},computed:{pagedVocabularyList(){const e=(this.wordTablePage-1)*this.wordTablePagePerPage,a=e+this.wordTablePagePerPage;return this.vocabularyList.slice(e,a)}},data:()=>({vocabularyList:[],selectedLevel:["초급","중급","고급"],levels:["초급","중급","고급"],tableHeaders:[{title:"번호",value:"index",sortable:!1,align:"center",class:"custom-header-style"},{title:"단어",value:"eng",sortable:!1,align:"center",class:"custom-header-style"},{title:"뜻",value:"kor",sortable:!1,align:"center",class:"custom-header-style"},{title:"레벨",value:"type",sortable:!1,align:"center",class:"custom-header-style"}],wordTablePage:1,wordTablePagePerPage:10,wordTableLoading:!0,wordTablePageCount:0}),mounted(){this.loadJsonAndGenerateQuiz()},methods:{setTablePage(){this.wordTablePageCount=Math.ceil(this.vocabularyList.length/this.wordTablePagePerPage)},loadJsonAndGenerateQuiz(){fetch("voca.json").then(e=>e.json()).then(e=>{this.vocabularyList=[];for(let a=0;a<this.selectedLevel.length;a++)for(let s=0;s<e.length;s++)this.selectedLevel[a]===e[s].type&&this.vocabularyList.push(e[s]);this.setTablePage(),this.wordTableLoading=!1}).catch(e=>{this.wordTableLoading=!1,console.error("JSON 파일을 로드하는 중 오류가 발생했습니다:",e)})},downloadExcel(){const e=this.vocabularyList.map(l=>({번호:l.index,단어:l.eng,뜻:l.kor,레벨:l.type})),a=r.json_to_sheet(e),s=r.book_new();r.book_append_sheet(s,a,"Sheet1");const c=`vocaWizQuiz_${new Date().toISOString().replace(/[-:.TZ]/g,"")}.xlsx`;m(s,c)}}};function z(e,a,s,b,c,l){return g(),u(V,{class:"fill-height"},{default:t(()=>[o(D,{class:"align-center text-center fill-height"},{default:t(()=>[o(y,null,{default:t(()=>[o(_,{modelValue:e.selectedLevel,"onUpdate:modelValue":a[0]||(a[0]=n=>e.selectedLevel=n),id:"selectedLevel",name:"selectedLevel",ref:"selectedLevel",items:e.levels,label:"레벨 선택",dense:"",outlined:"",chips:"",multiple:"","hide-details":"",color:"fontColor",onChange:l.loadJsonAndGenerateQuiz},null,8,["modelValue","items","onChange"])]),_:1}),l.pagedVocabularyList.length>0?(g(),u(w,{key:0,style:{margin:"1vh 0px !important"}},{default:t(()=>[o(C,{style:{color:"#FF6347 !important"},color:"mainColor",width:"100%",onClick:l.downloadExcel},{default:t(()=>[h("다운로드")]),_:1},8,["onClick"])]),_:1})):P("",!0),o(k),o(p,{id:"wordTable",headers:e.tableHeaders,items:l.pagedVocabularyList,pagination:{page:e.wordTablePage,itemsPerPage:e.wordTablePagePerPage},"item-key":"index",loading:e.wordTableLoading,"loading-text":"잠시만 기다려 주세요."},{top:t(()=>[d(o(S,{color:"mianColor",indeterminate:""},null,512),[[i,e.wordTableLoading]])]),"no-data":t(()=>[d(o(f,null,{default:t(()=>[h(" 😮단어 정보가 없어요! ")]),_:1},512),[[i,!e.wordTableLoading]]),d(L("span",null,"잠시만 기다려 주세요.",512),[[i,e.wordTableLoading]])]),bottom:t(()=>[]),_:1},8,["headers","items","pagination","loading"]),o(v,{modelValue:e.wordTablePage,"onUpdate:modelValue":a[1]||(a[1]=n=>e.wordTablePage=n),length:e.wordTablePageCount,"total-visible":3,rounded:"circle","prev-icon":"mdi-menu-left","next-icon":"mdi-menu-right",color:"fontColor"},null,8,["modelValue","length"])]),_:1})]),_:1})}const J=T(x,[["render",z],["__scopeId","data-v-f8cb86ad"]]);export{J as default};
